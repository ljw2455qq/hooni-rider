<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GPS Sender (핸드폰)</title>
</head>
<body>
  <h1>GPS 데이터 전송 중</h1>
  <p id="status">GPS 대기 중...</p>

  <script type="module">
    import { db } from './firebase.js';  // src/firebase.js 경로에 맞게 조정
    import { ref, set } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-database.js";

    function sendGPS(position) {
      const latitude = position.coords.latitude;
      const longitude = position.coords.longitude;
      set(ref(db, 'gps'), {
        latitude: latitude,
        longitude: longitude,
        timestamp: Date.now()
      });
      document.getElementById('status').innerText = `전송: 위도 ${latitude}, 경도 ${longitude}`;
    }

    function handleError(error) {
      document.getElementById('status').innerText = `오류: ${error.message}`;
    }

    if (navigator.geolocation) {
      navigator.geolocation.watchPosition(sendGPS, handleError, {
        enableHighAccuracy: true,
        timeout: 5000,
        maximumAge: 0
      });
    } else {
      document.getElementById('status').innerText = "GPS 지원 안 됨";
    }
  </script>
</body>
</html>
